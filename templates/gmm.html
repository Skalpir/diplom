{% extends "layout.html" %}
{% block title %}–ê–Ω–∞–ª—ñ–∑ GMM{% endblock %}
{% block content %}
<h2>üß™ –ó–∞–ø—É—Å–∫ GMM-–∞–Ω–∞–ª—ñ–∑—É</h2>
<p>–¶—è —Å—Ç–æ—Ä—ñ–Ω–∫–∞ –¥–æ–∑–≤–æ–ª—è—î –≤–∏–∫–æ–Ω–∞—Ç–∏ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü—ñ—é —Ç–∞ –≤–∏—è–≤–ª–µ–Ω–Ω—è –∞–Ω–æ–º–∞–ª—ñ–π –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Gaussian Mixture Model.</p>

<form id="gmm-form" method="POST" action="/run_gmm" enctype="multipart/form-data">
  <div class="mb-3">
    <label for="n_components" class="form-label">–ö—ñ–ª—å–∫—ñ—Å—Ç—å –∫–ª–∞—Å—Ç–µ—Ä—ñ–≤</label>
    <input type="number" class="form-control" id="n_components" name="n_components" value="3" min="1">
  </div>

  <div class="mb-3">
    <label for="max_iter" class="form-label">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —ñ—Ç–µ—Ä–∞—Ü—ñ–π</label>
    <input type="number" class="form-control" id="max_iter" name="max_iter" value="100" min="1">
  </div>

  <div class="mb-3">
    <label for="covariance_type" class="form-label">–¢–∏–ø –∫–æ–≤–∞—Ä—ñ–∞—Ü—ñ—ó</label>
    <select class="form-select" id="covariance_type" name="covariance_type">
      <option value="full" selected>full</option>
      <option value="tied">tied</option>
      <option value="diag">diag</option>
      <option value="spherical">spherical</option>
    </select>
  </div>

  <div class="mb-3">
    <label for="gmm_impl" class="form-label">–í–∏–±—ñ—Ä —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó GMM</label>
    <select class="form-select" id="gmm_impl" name="gmm_impl">
      <option value="my-gmm">my-gmm</option>
      <option value="sklearn-gmm">sklearn-gmm</option>
    </select>
  </div>

  <div class="mb-3">
    <label for="file" class="form-label">–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ CSV-—Ñ–∞–π–ª (–Ω–µ–æ–±–æ–≤‚Äô—è–∑–∫–æ–≤–æ)</label>
    <input class="form-control" type="file" id="file" name="file" accept=".csv">
  </div>

  <input type="hidden" name="selected_file" id="selected_file">

  <button type="submit" class="btn btn-success">üîÅ –ó–∞–ø—É—Å—Ç–∏—Ç–∏ GMM</button>
</form>

<div id="loading" style="display: none;" class="mt-3 alert alert-info">
  üîÑ –ê–Ω–∞–ª—ñ–∑ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è... –ó–∞—á–µ–∫–∞–π—Ç–µ, –±—É–¥—å –ª–∞—Å–∫–∞.
</div>

<hr>

<h4>üìÇ –ê–±–æ –æ–±–µ—Ä—ñ—Ç—å –Ω–∞—è–≤–Ω–∏–π CSV-—Ñ–∞–π–ª —ñ–∑ –ø–∞–ø–∫–∏ <code>uploads</code>:</h4>
<table class="table table-striped">
  <thead>
    <tr>
      <th>–§–∞–π–ª</th>
      <th>–î–∞—Ç–∞</th>
      <th>–†–æ–∑–º—ñ—Ä</th>
      <th>–î—ñ—è</th>
    </tr>
  </thead>
  <tbody>
    {% for file in files[:10] %}
    <tr>
      <td>{{ file.name }}</td>
      <td>{{ file.mtime }}</td>
      <td>{{ file.size }}</td>
      <td>
        <button type="button" class="btn btn-outline-primary btn-sm" onclick="selectFile('{{ file.name }}')">–í–∏–±—Ä–∞—Ç–∏</button>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<hr>
<a href="{{ url_for('results') }}" class="btn btn-outline-secondary">üìä –ü–µ—Ä–µ–π—Ç–∏ –¥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤</a>

<script>
  function selectFile(filename) {
    document.getElementById('selected_file').value = filename;
    alert("–§–∞–π–ª " + filename + " –≤–∏–±—Ä–∞–Ω–æ –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É");
  }

  document.getElementById('gmm-form').addEventListener('submit', function() {
    document.getElementById('loading').style.display = 'block';
  });
</script>
{% endblock %}
